<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MacrOS</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
/* ========================= GENERAL ========================= */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: #f5f5f7;
  color: #000;
  margin: 20px;
  transition: all 0.3s;
}
header {
  text-align: center;
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 15px;
  color: #000;
}
.top-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 25px;
}
.top-buttons button {
  background: #007bff;
  color: white;
  border: none;
  padding: 8px 14px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  border-radius: 8px;
  transition: 0.2s;
}
.top-buttons button:hover {
  background: #0056d6;
}

/* ========================= LAYOUT ========================= */
main {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}
.left-column {
  flex: 1;
  min-width: 350px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}
.right-column {
  flex: 1;
  min-width: 350px;
}

/* ========================= QUICK NOTES ========================= */
.quick-card {
  background: #fff;
  border-radius: 8px;
  padding: 10px;
  box-shadow: 0 6px 15px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
}
.quick-card-header {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 8px;
}
.quick-card-header h3 { margin: 0; margin-right: 10px; }
.quick-toggle-btn {
  background: #007bff;
  color: white;
  border: none;
  border-radius: 50%;
  width: 30px;
  height: 30px;
  cursor: pointer;
  font-weight: bold;
}
.quick-toggle-btn:hover { background: #0056d6; }
.quick-buttons, .sub-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 8px;
  justify-content: center;
}
.quick-btn, .sub-btn {
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 6px 10px;
  cursor: pointer;
  font-weight: bold;
}
.quick-btn:hover, .sub-btn:hover { background: #0056d6; }

/* ========================= MANAGE QUICK NOTES ========================= */
.manage-quick {
  margin-top: 12px;
  border-top: 1px solid #eee;
  padding-top: 10px;
}
.manage-quick input, .manage-quick textarea {
  padding: 6px;
  margin-bottom: 6px;
}
.manage-quick button {
  background: #007bff;
  color: #fff;
  border: none;
  padding: 6px 8px;
  border-radius: 6px;
  cursor: pointer;
}
.manage-quick .button-row {
  display: flex;
  gap: 8px;
  align-items: center;
}

/* ========================= FORM CARD ========================= */
.card {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 6px 15px rgba(0,0,0,0.08);
}
label {
  font-weight: 600;
  margin: 10px 0 5px;
  text-transform: uppercase;
}
input, select, textarea {
  width: 100%;
  box-sizing: border-box;
  padding: 8px 12px;
  margin-bottom: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  background: #f2f2f7;
  font-size: 0.95rem;
  color: #000;
}
textarea { resize: vertical; }

/* Cambios solicitados */
#inquiry, #actionTaken {
  resize: vertical;
  min-height: 30px;
  max-height: 100px;
}

/* ========================= CEX ========================= */
.cex-buttons {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin: 10px 0 12px;
}
.cex-buttons button {
  flex: 1;
  color: #fff;
  border: none;
  padding: 6px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  max-width: 120px;
}
.cex-good { background: #34c759; }
.cex-neutral { background: #ff9500; }
.cex-bad { background: #ff3b30; }

/* ========================= OUTPUT ========================= */
.output { display: flex; flex-direction: column; }
.output textarea {
  width: 100%;
  min-height: 150px;
  border-radius: 6px;
  padding: 12px;
  margin-bottom: 5px;
  background: #f2f2f7;
  font-family: monospace;
  font-size: 0.95rem;
  color: #000;
}
.copy-container { display: flex; justify-content: flex-end; gap: 5px; }
.copy-container button {
  background: #007bff;
  color: white;
  border: none;
  padding: 6px 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  border-radius: 6px;
}
.copy-container button:hover { background: #0056d6; }

/* ========================= DARK MODE ========================= */
body.dark { background: #121212; color: white; }
body.dark header { color: #fff; }
body.dark .card, body.dark .quick-card {
  background: #1e1e1e;
  border: 1px solid #444;
  box-shadow: none;
  color: #fff;
}
body.dark input, body.dark select, body.dark textarea {
  background: #2a2a2a;
  color: white;
  border: 1px solid #555;
}
body.dark .copy-container button, body.dark .top-buttons button {
  border: 1px solid #fff;
  background: none;
  color: white;
}
body.dark .cex-buttons button { color: #fff; }
body.dark .quick-card-header h3 { color: #fff; }
body.dark #historyPanel { background: #2c2c2c; color: white; }

/* ========================= HISTORY ========================= */
#historyBackdrop {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 999;
  opacity: 0;
  transition: opacity 0.3s;
}
#historyBackdrop.active { display: block; opacity: 1; }
#historyPanel {
  display: none;
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%,-50%) scale(0.9);
  width: 420px;
  max-height: 75%;
  overflow-y: auto;
  z-index: 1000;
  background: #e0e0e0;
  border-radius: 6px;
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
  padding: 20px;
  opacity: 0;
  transition: all 0.25s ease;
}
#historyPanel.active { display: block; opacity: 1; transform: translate(-50%,-50%) scale(1); }
#historyPanel h3 { margin-top: 0; text-align: center; }
#historyPanel ul { list-style: none; padding: 0; margin: 0; }
#historyPanel li {
  padding: 8px 10px;
  margin-bottom: 6px;
  background: #f5f5f5;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.2s;
}
#historyPanel li:hover { background: #ccc; }
#clearHistoryBtn {
  width: 100%; padding: 6px;
  border: none; border-radius: 6px;
  cursor: pointer; font-weight: bold;
  margin-top: 10px;
  background: #ff3b30; color: white;
}
#closeHistoryBtn {
  width: 100%; padding: 6px;
  border: none; border-radius: 6px;
  cursor: pointer; font-weight: bold;
  margin-top: 10px;
  background: #007bff; color: white;
}

/* ========================= UNDO ========================= */
#undoBtn {
  background: #34c759;
  color: white;
  border: none;
  padding: 6px 12px;
  cursor: pointer;
  border-radius: 6px;
  display: none;
}

/* ========================= RESPONSIVE ========================= */
@media (max-width:900px){ main{flex-direction:column;} #historyPanel{width:90%;}}
</style>
</head>
<body>
<header>MacrOS</header>

<div class="top-buttons">
  <button id="newCallBtn"><i class="fa fa-plus"></i> New Call</button>
  <button id="historyBtn"><i class="fa fa-clock"></i> History</button>
  <button id="darkModeBtn"><i class="fa fa-moon"></i> Dark Mode</button>
</div>

<main>
  <!-- LEFT -->
  <div class="left-column">
    <div class="quick-card">
      <div class="quick-card-header">
        <h3>Quick Notes</h3>
        <button class="quick-toggle-btn">+</button>
      </div>
      <div class="quick-buttons" id="quickNotes"></div>
      <div class="sub-buttons" id="subNotes"></div>
      <div class="manage-quick">
        <input type="text" id="quickName" placeholder="Category name">
        <textarea id="quickContent" placeholder="Quick note text"></textarea>
        <div class="button-row">
          <button id="addQuickBtn"><i class="fa fa-plus"></i> Add</button>
          <button id="deleteQuickBtn"><i class="fa fa-trash"></i> Delete</button>
          <button id="editQuickBtn"><i class="fa fa-edit"></i> Edit</button>
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT -->
  <div class="right-column">
    <div class="card">
      <label>Account</label>
      <input type="text" id="account" placeholder="Account">

      <label>Inquiry</label>
      <textarea id="inquiry" placeholder="Inquiry"></textarea>

      <label>Action Taken</label>
      <textarea id="actionTaken" placeholder="Action Taken"></textarea>

      <label>CEX</label>
      <div class="cex-buttons">
        <button class="cex-good">Good</button>
        <button class="cex-neutral">Neutral</button>
        <button class="cex-bad">Bad</button>
      </div>

      <label>Additional Notes</label>
      <textarea id="notes" placeholder="Additional notes"></textarea>

      <div class="output">
        <textarea id="outputText" readonly></textarea>
        <div class="copy-container">
          <button id="copyBtn"><i class="fa fa-copy"></i> Copy</button>
          <button id="undoBtn"><i class="fa fa-undo"></i> Undo</button>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- History -->
<div id="historyBackdrop"></div>
<div id="historyPanel">
  <h3>History</h3>
  <ul id="historyList"></ul>
  <button id="clearHistoryBtn"><i class="fa fa-trash"></i> Clear History</button>
  <button id="closeHistoryBtn"><i class="fa fa-times"></i> Close</button>
</div>

<script>
/* ========================= STATE ========================= */
const account=document.getElementById("account"),
inquiry=document.getElementById("inquiry"),
actionTaken=document.getElementById("actionTaken"),
notes=document.getElementById("notes"),
outputText=document.getElementById("outputText"),
copyBtn=document.getElementById("copyBtn"),
undoBtn=document.getElementById("undoBtn"),
newCallBtn=document.getElementById("newCallBtn"),
historyBtn=document.getElementById("historyBtn"),
darkModeBtn=document.getElementById("darkModeBtn"),
quickNotes=document.getElementById("quickNotes"),
subNotes=document.getElementById("subNotes"),
quickName=document.getElementById("quickName"),
quickContent=document.getElementById("quickContent"),
addQuickBtn=document.getElementById("addQuickBtn"),
deleteQuickBtn=document.getElementById("deleteQuickBtn"),
editQuickBtn=document.getElementById("editQuickBtn"),
historyList=document.getElementById("historyList"),
historyPanel=document.getElementById("historyPanel"),
historyBackdrop=document.getElementById("historyBackdrop"),
clearHistoryBtn=document.getElementById("clearHistoryBtn"),
closeHistoryBtn=document.getElementById("closeHistoryBtn");

let lastOutput="",history=[],
quickData=JSON.parse(localStorage.getItem("quickData")||"{}"),
darkMode=localStorage.getItem("darkMode")==="true";

/* ========================= FUNCTIONS ========================= */
function updateOutput(){
  const acc=account.value.trim(),
  inq=inquiry.value.trim(),
  act=actionTaken.value.trim(),
  nts=notes.value.trim(),
  cex=document.querySelector(".cex-buttons button.active");
  let text="";
  if(acc) text+="Account: "+acc+"\\n";
  if(inq) text+="Inquiry: "+inq+"\\n";
  if(act) text+="Action Taken: "+act+"\\n";
  if(cex) text+="CEX: "+cex.textContent+"\\n";
  if(nts) text+="Notes: "+nts+"\\n";
  outputText.value=text;
}
function saveHistory(){
  if(outputText.value.trim()){
    history.unshift(outputText.value.trim());
    localStorage.setItem("history",JSON.stringify(history));
    renderHistory();
  }
}
function renderHistory(){
  historyList.innerHTML="";
  history.forEach((item,i)=>{
    const li=document.createElement("li");
    li.textContent=item.split("\\n")[0]+"...";
    li.onclick=()=>{outputText.value=item;};
    historyList.appendChild(li);
  });
}
function renderQuickNotes(){
  quickNotes.innerHTML="";
  Object.keys(quickData).forEach(cat=>{
    const btn=document.createElement("button");
    btn.textContent=cat;
    btn.className="quick-btn";
    btn.onclick=()=>showSubNotes(cat);
    quickNotes.appendChild(btn);
  });
}
function showSubNotes(cat){
  subNotes.innerHTML="";
  quickData[cat].forEach(txt=>{
    const btn=document.createElement("button");
    btn.textContent=txt.substring(0,20);
    btn.className="sub-btn";
    btn.onclick=()=>{notes.value+=" "+txt;updateOutput();};
    subNotes.appendChild(btn);
  });
}
function toggleDark(){document.body.classList.toggle("dark");darkMode=!darkMode;localStorage.setItem("darkMode",darkMode);}
function newCall(){account.value="";inquiry.value="";actionTaken.value="";notes.value="";document.querySelectorAll(".cex-buttons button").forEach(b=>b.classList.remove("active"));updateOutput();}
function copyOutput(){if(outputText.value){navigator.clipboard.writeText(outputText.value);undoBtn.style.display="inline-block";lastOutput=outputText.value;saveHistory();}}
function undo(){outputText.value=lastOutput;undoBtn.style.display="none";}
function addQuick(){const cat=quickName.value.trim(),txt=quickContent.value.trim();if(!cat||!txt)return;if(!quickData[cat])quickData[cat]=[];quickData[cat].push(txt);localStorage.setItem("quickData",JSON.stringify(quickData));renderQuickNotes();}
function deleteQuick(){const cat=quickName.value.trim();if(cat&&quickData[cat]){delete quickData[cat];localStorage.setItem("quickData",JSON.stringify(quickData));renderQuickNotes();}}
function editQuick(){const cat=quickName.value.trim(),txt=quickContent.value.trim();if(cat&&txt&&quickData[cat]){quickData[cat]=[txt];localStorage.setItem("quickData",JSON.stringify(quickData));renderQuickNotes();}}

/* ========================= EVENTS ========================= */
[account,inquiry,actionTaken,notes].forEach(el=>el.addEventListener("input",updateOutput));
document.querySelectorAll(".cex-buttons button").forEach(btn=>btn.addEventListener("click",()=>{document.querySelectorAll(".cex-buttons button").forEach(b=>b.classList.remove("active"));btn.classList.add("active");updateOutput();}));
copyBtn.onclick=copyOutput;
undoBtn.onclick=undo;
newCallBtn.onclick=newCall;
darkModeBtn.onclick=toggleDark;
addQuickBtn.onclick=addQuick;
deleteQuickBtn.onclick=deleteQuick;
editQuickBtn.onclick=editQuick;
historyBtn.onclick=()=>{historyPanel.classList.add("active");historyBackdrop.classList.add("active");};
closeHistoryBtn.onclick=()=>{historyPanel.classList.remove("active");historyBackdrop.classList.remove("active");};
clearHistoryBtn.onclick=()=>{history=[];localStorage.removeItem("history");renderHistory();};

/* ========================= INIT ========================= */
history=JSON.parse(localStorage.getItem("history")||"[]");
renderHistory();
renderQuickNotes();
if(darkMode)document.body.classList.add("dark");
updateOutput();
</script>
</body>
</html>
