agent-hub-v1.0
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sales Dashboard - Veronica Sale Mag</title>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
  /* ===========================
     Sales Dashboard - CSS (organized by blocks)
     =========================== */

  /* -------- Variables / reset -------- */
  :root{
    --bg-left: #ffffff;
    --bg-right: #b6f0e8;
    --accent: #2b9fa0; /* turquoise dark */
    --accent-2: #60e1d6; /* lighter turquoise */
    --muted: #5b6b6b;
    --glass-alpha: 0.22;
    --card-radius: 14px;
    --text-dark: #121318;
    --black-card: #0b0b0d;
    --shadow: 0 8px 30px rgba(16,24,32,0.12);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial; -webkit-font-smoothing:antialiased}
  body{
    background: linear-gradient(45deg,var(--bg-left),var(--bg-right));
    color:var(--text-dark);
    padding:28px;
  }

  /* Dark mode variables on body.dark */
  body.dark{
    --bg-left:#0b1220;
    --bg-right:#121827;
    --accent:#0fb2a9;
    --accent-2:#49cfc6;
    --muted:#9aa3ad;
    --glass-alpha:0.14;
    --text-dark:#eef2f6;
    --black-card:#0f1720;
    background: linear-gradient(45deg, #07121a, #0f1a23);
  }

  /* -------- Layout -------- */
  .app {
    max-width:1280px;
    margin:0 auto;
    display:grid;
    grid-template-columns: 72px 1fr;
    gap:20px;
    align-items:start;
    min-height: calc(100vh - 56px);
  }

  /* Left vertical nav icons (like the reference) */
  .side-nav {
    display:flex;
    flex-direction:column;
    gap:12px;
    align-items:center;
    padding-top:8px;
  }
  .nav-ico {
    width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;
    background: rgba(255,255,255,0.25); backdrop-filter: blur(8px); box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,0.06);
    cursor:pointer; transition: transform .18s ease;
  }
  body.dark .nav-ico { background: rgba(255,255,255,0.04); border-color: rgba(255,255,255,0.04); }
  .nav-ico:hover { transform: translateY(-6px); }

  /* Main header / top area spanning right column */
  .main {
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:18px;
  }

  /* Top header row (greeting + search + actions) */
  .header {
    grid-column: 1 / -1;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    margin-bottom:6px;
  }
  .greeting { font-size:18px; font-weight:700; color:var(--text-dark); }
  .sub { font-size:13px; color:var(--muted); margin-top:4px; }

  .header-actions { display:flex; gap:8px; align-items:center; }

  .btn {
    border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700; background: rgba(255,255,255,0.28);
    backdrop-filter: blur(8px); transition: all .18s ease; box-shadow: 0 6px 22px rgba(0,0,0,0.06);
  }
  .btn:hover{ transform: translateY(-3px); }

  .btn.primary { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; box-shadow: 0 8px 24px rgba(45,140,140,0.12); }
  body.dark .btn { background: rgba(255,255,255,0.04); color:var(--text-dark); }
  body.dark .btn.primary { box-shadow: 0 8px 24px rgba(0,200,180,0.08); }

  /* -------- Dashboard grid: left column content and right column components -------- */
  .left-col {
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  /* Stats cards grid 2x2 */
  .stats-grid {
    display:grid;
    grid-template-columns: repeat(2,1fr);
    gap:14px;
  }
  .stat-card {
    padding:18px; border-radius:12px; background:rgba(255,255,255,var(--glass-alpha)); backdrop-filter: blur(12px); box-shadow:var(--shadow); border: 1px solid rgba(255,255,255,0.06);
  }
  body.dark .stat-card { background: rgba(255,255,255,0.03); border-color: rgba(255,255,255,0.04); }

  .stat-title { font-size:13px; color:var(--muted); }
  .stat-value { font-size:20px; font-weight:800; margin-top:6px; color:var(--text-dark); }

  /* Black highlighted card (comissions tracker) */
  .black-card {
    background: linear-gradient(180deg, rgba(6,7,9,0.95), rgba(12,12,14,0.95));
    color:white; padding:18px; border-radius:12px; box-shadow: 0 12px 40px rgba(2,8,12,0.5);
  }
  .black-card .value { font-size:28px; font-weight:800; }

  /* Chart container (main graph similar to reference) */
  .chart-card {
    background: rgba(255,255,255,var(--glass-alpha)); padding:16px; border-radius:12px; box-shadow:var(--shadow); border:1px solid rgba(255,255,255,0.06);
  }

  .chart-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
  .chart-title { font-weight:700; color:var(--text-dark); }

  /* Right column (sale tracker + tiers) */
  .right-col { display:flex; flex-direction:column; gap:14px; }

  .sale-tracker-card { padding:14px; border-radius:12px; background: rgba(255,255,255,var(--glass-alpha)); backdrop-filter: blur(12px); box-shadow:var(--shadow); border:1px solid rgba(255,255,255,0.06); display:flex; gap:12px; }
  .sale-controls { width:320px; display:flex; flex-direction:column; gap:10px; }
  .sale-list { flex:1; display:flex; flex-direction:column; gap:8px; max-height:420px; overflow:auto; padding-right:4px; }

  .selector { display:flex; flex-wrap:wrap; gap:8px; }
  .selector button { padding:8px 10px; border-radius:10px; border:none; background:rgba(255,255,255,0.18); cursor:pointer; font-weight:700; }
  .selector button.active { background: var(--accent); color:white; box-shadow: 0 8px 20px rgba(15,139,141,0.12); }

  .input { padding:10px; border-radius:10px; border:1px solid rgba(0,0,0,0.06); width:100%; }

  .sale-row { display:flex; justify-content:space-between; align-items:center; padding:10px; border-radius:8px; background: rgba(255,255,255,0.12); }
  body.dark .sale-row { background: rgba(255,255,255,0.03); }

  /* Sales per tier list card */
  .tier-card { padding:12px; border-radius:12px; background: rgba(255,255,255,var(--glass-alpha)); box-shadow:var(--shadow); border:1px solid rgba(255,255,255,0.06); }

  /* Small utilities */
  .muted { color:var(--muted); font-size:13px; }
  .small { font-size:12px; color:var(--muted) }

  /* responsive */
  @media (max-width: 960px){
    .app { grid-template-columns: 56px 1fr; padding:12px; }
    .main { grid-template-columns: 1fr; }
    .right-col { order: 2; }
    .left-col { order: 1; }
    .sale-controls { width:100%; }
  }
  </style>
</head>
<body>
  <div class="app">
    <!-- Left tiny nav -->
    <div class="side-nav">
      <div class="nav-ico" title="Home" data-route="home">üè†</div>
      <div class="nav-ico" title="Sales Tracker" data-route="tracker">üßæ</div>
      <div class="nav-ico" title="QA" data-route="qa">üìä</div>
      <div class="nav-ico" title="Settings" data-route="settings">‚öôÔ∏è</div>
    </div>

    <!-- Main content -->
    <div style="width:100%">
      <div class="main">
        <!-- Header -->
        <div class="header">
          <div>
            <div class="greeting">Hi, Veronica!</div>
            <div class="sub">Sales Dashboard ‚Ä¢ Veronica Sale Mag</div>
          </div>
          <div class="header-actions">
            <button class="btn" id="btn-landing">Landing</button>
            <button class="btn" id="btn-tracker">Sales Tracker</button>
            <button class="btn" id="btn-qa">QA Progress</button>
            <button class="btn primary" id="darkToggleTop">Dark Mode</button>
          </div>
        </div>

        <!-- LEFT COLUMN -->
        <div class="left-col">
          <!-- stats grid -->
          <div class="stats-grid">
            <div class="stat-card stat-card-1 stat-card stat-card">
              <div class="stat-title">Sales</div>
              <div class="stat-value" id="card-sales">0</div>
              <div class="small muted">Cantidad de ventas cerradas</div>
            </div>

            <div class="stat-card">
              <div class="stat-title">Commissions (USD)</div>
              <div class="stat-value" id="card-com"> $0.00</div>
              <div class="small muted">Total comisiones acumuladas</div>
            </div>

            <div class="stat-card">
              <div class="stat-title">Raw Sales</div>
              <div class="stat-value" id="card-raw">0</div>
              <div class="small muted">Registros totales</div>
            </div>

            <div class="stat-card">
              <div class="stat-title">Save the Sales (STS)</div>
              <div class="stat-value" id="card-sts">0</div>
              <div class="small muted">Cantidad STS</div>
            </div>
          </div>

          <!-- big chart card -->
          <div class="chart-card" id="landingView">
            <div class="chart-header">
              <div>
                <div class="chart-title">Annual Commissions</div>
                <div class="small muted">Commissions per month (USD)</div>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <div class="small muted">View:</div>
                <select id="chartMode" class="input" style="width:140px;padding:6px;border-radius:8px;">
                  <option value="monthly">Monthly</option>
                  <option value="weekly">Weekly</option>
                </select>
              </div>
            </div>
            <canvas id="commChart" height="140"></canvas>

            <!-- below chart summary row -->
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
              <div style="display:flex;gap:12px;align-items:center">
                <div class="black-card">
                  <div class="small">Commissions earned</div>
                  <div class="value" id="blackCommission">$0.00</div>
                </div>
                <div style="min-width:20px"></div>
                <div>
                  <div class="small muted">Top brands</div>
                  <div style="font-weight:800">AquaTru ‚Ä¢ AirDoctor ‚Ä¢ Walkfit</div>
                </div>
              </div>

              <div style="display:flex;gap:8px;align-items:center">
                <button class="btn" id="toTracker">Go to Sales Tracker</button>
                <button class="btn" id="toQA">Go to QA Page</button>
              </div>
            </div>
          </div>

          <!-- hidden QA view placeholder (shown when QA selected) -->
          <div class="chart-card" id="qaView" style="display:none">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="chart-title">Quality Assurance</div>
                <div class="small muted">QA Score & insights</div>
              </div>
            </div>
            <div style="display:flex;gap:14px;margin-top:12px">
              <div style="flex:1">
                <div style="background:rgba(255,255,255,0.06);padding:14px;border-radius:10px">
                  <div style="font-size:28px;font-weight:800">92%</div>
                  <div class="small muted">QA Score this month</div>
                </div>
              </div>
              <div style="flex:2">
                <canvas id="qaChart" height="120"></canvas>
              </div>
            </div>
          </div>

        </div> <!-- end left-col -->

        <!-- RIGHT COLUMN -->
        <div class="right-col">
          <!-- Sale tracker (default visible card) -->
          <div class="sale-tracker-card" id="trackerCard">
            <div class="sale-list">
              <div class="small muted">Added sales (latest first)</div>
              <div id="salesListInner">
                <!-- list items here -->
              </div>
            </div>

            <div class="sale-controls">
              <div class="small muted">Brand</div>
              <div class="selector" id="brandButtons"></div>

              <div class="small muted" style="margin-top:8px">Price range</div>
              <div class="selector" id="rangeButtons">
                <button data-min="1" data-max="399">$1 - $399</button>
                <button data-min="400" data-max="599">$400 - $599</button>
                <button data-min="600" data-max="899">$600 - $899</button>
                <button data-min="900" data-max="999999">$900+</button>
              </div>

              <div style="margin-top:8px">
                <div class="small muted">Price (USD)</div>
                <input id="priceValue" class="input" type="number" placeholder="e.g. 499" />
              </div>

              <label style="margin-top:8px"><input type="checkbox" id="isSts" /> <span class="small muted">Save the Sale (STS) - fixed commission $1.65</span></label>

              <div style="margin-top:8px;display:flex;gap:8px">
                <button class="add-btn" id="addSaleBtn">Add Sale</button>
                <button class="btn" id="exportCsvBtn">Export CSV</button>
              </div>

              <div style="margin-top:10px">
                <div class="small muted">Commissions by tier</div>
                <div id="tiersInfo" class="small muted"></div>
              </div>
            </div>
          </div>

          <!-- sales per tier summary -->
          <div class="tier-card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="small muted">Sales per Brand</div>
              <div class="small muted">Count</div>
            </div>
            <div id="salesPerBrand"></div>
          </div>

          <!-- optional extra space -->
          <div class="tier-card">
            <div class="small muted">Agent schedule</div>
            <div class="small">Mon-Fri: 9:00 - 18:00</div>
          </div>
        </div> <!-- end right-col -->

      </div> <!-- end main -->
    </div> <!-- end right of app -->
  </div> <!-- end app -->

<script>
/* ===========================
   JS: logic for dashboard + charts + sales tracker
   - No external server required.
   - Saves data in localStorage.
   =========================== */

(function(){
  // --- Data & config ---
  const BRANDS = ['AirDoctor','AquaTru','Prosvent','IdealProstate+','BetterBladder','Walkfit','RotoRazer','Superthotics','MiracleBlade'];
  const TIERS = [
    {name:'Tier 1', min:1, max:399, comm:1.65},
    {name:'Tier 2', min:400, max:599, comm:3.30},
    {name:'Tier 3', min:600, max:899, comm:5.00},
    {name:'Tier 4', min:900, max:Infinity, comm:8.30},
  ];

  const STORAGE_KEY = 'sales_dashboard_v1';

  // --- DOM references ---
  const cardSales = document.getElementById('card-sales');
  const cardCom = document.getElementById('card-com');
  const cardRaw = document.getElementById('card-raw');
  const cardSts = document.getElementById('card-sts');
  const blackCommission = document.getElementById('blackCommission');

  const brandButtons = document.getElementById('brandButtons');
  const rangeButtons = document.getElementById('rangeButtons');
  const priceValue = document.getElementById('priceValue');
  const isSts = document.getElementById('isSts');
  const addSaleBtn = document.getElementById('addSaleBtn');
  const salesListInner = document.getElementById('salesListInner');
  const exportCsvBtn = document.getElementById('exportCsvBtn');
  const salesPerBrand = document.getElementById('salesPerBrand');
  const tiersInfo = document.getElementById('tiersInfo');

  const toTracker = document.getElementById('toTracker');
  const toQA = document.getElementById('toQA');
  const btnTracker = document.getElementById('btn-tracker');
  const btnLanding = document.getElementById('btn-landing');
  const btnQA = document.getElementById('btn-qa');

  const chartMode = document.getElementById('chartMode');

  // --- chart instances ---
  let commChart = null;
  let qaChart = null;

  // --- state ---
  let state = {
    sales: loadSales(),
    selectedBrand: null,
    selectedRange: null,
    dark: (localStorage.getItem('sales_dash_dark') === '1')
  };

  // apply dark initial
  if(state.dark) document.body.classList.add('dark');

  // --- helpers ---
  function saveSales(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state.sales));
  }
  function loadSales(){
    try{
      return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    }catch(e){ return [];}
  }
  function money(v){ return '$' + Number(v).toFixed(2); }

  function findTier(price){
    for(const t of TIERS) if(price >= t.min && price <= t.max) return t;
    return TIERS[TIERS.length-1];
  }

  // --- render brand buttons ---
  BRANDS.forEach(b=>{
    const btn = document.createElement('button');
    btn.textContent = b;
    btn.onclick = ()=> {
      document.querySelectorAll('#brandButtons button').forEach(x=>x.classList.remove('active'));
      btn.classList.add('active');
      state.selectedBrand = b;
    };
    brandButtons.appendChild(btn);
  });

  // price range click behavior
  rangeButtons.querySelectorAll('button').forEach(btn=>{
    btn.addEventListener('click', ()=> {
      rangeButtons.querySelectorAll('button').forEach(x=>x.classList.remove('active'));
      btn.classList.add('active');
      state.selectedRange = {min:+btn.dataset.min, max:+btn.dataset.max};
      // set default price to mid-range
      const mid = Math.round((state.selectedRange.min + Math.min(state.selectedRange.max, state.selectedRange.min + 200))/2);
      priceValue.value = mid;
    });
  });

  // render tiers info small
  function renderTierInfo(){
    tiersInfo.innerHTML = TIERS.map(t => `${t.name}: $${t.comm.toFixed(2)}`).join(' ‚Ä¢ ');
  }
  renderTierInfo();

  // --- add sale behavior ---
  addSaleBtn.addEventListener('click', ()=>{
    if(!state.selectedBrand){ alert('Select a brand first'); return; }
    const price = Number(priceValue.value);
    if(!price || price <= 0){ alert('Enter a valid price'); return; }
    const sts = isSts.checked;
    let commission = sts ? 1.65 : findTier(price).comm;
    const sale = {
      id: Date.now(),
      brand: state.selectedBrand,
      price: price,
      commission: commission,
      sts: !!sts,
      date: new Date().toLocaleString()
    };
    state.sales.unshift(sale);
    saveSales();
    refreshUI();
  });

  // --- render sales list ---
  function renderSalesList(){
    salesListInner.innerHTML = '';
    if(state.sales.length === 0){
      salesListInner.innerHTML = '<div class="muted small">No sales yet. Add one to start registering.</div>';
      return;
    }
    state.sales.forEach(s=>{
      const div = document.createElement('div');
      div.className = 'sale-row';
      div.innerHTML = `<div>
          <div style="font-weight:700">${s.brand}</div>
          <div class="small muted">${s.date}${s.sts ? ' ‚Ä¢ STS' : ''}</div>
        </div>
        <div style="text-align:right">
          <div style="font-weight:800;color:var(--accent)">${money(s.price)}</div>
          <div class="small muted">Com: ${money(s.commission)}</div>
        </div>`;
      salesListInner.appendChild(div);
    });
  }

  // --- compute metrics & render cards ---
  function computeMetrics(){
    const totalSalesCount = state.sales.length;
    const totalRaw = state.sales.length;
    const totalCom = state.sales.reduce((a,b)=>a + Number(b.commission), 0);
    const stsCount = state.sales.filter(s=>s.sts).length;
    cardSales.textContent = totalSalesCount;
    cardCom.textContent = money(totalCom);
    cardRaw.textContent = totalRaw;
    cardSts.textContent = stsCount;
    blackCommission.textContent = money(totalCom);
  }

  // --- sales per brand render ---
  function renderSalesPerBrand(){
    const counts = {};
    for(const s of state.sales){ counts[s.brand] = (counts[s.brand]||0) + 1; }
    salesPerBrand.innerHTML = '';
    if(Object.keys(counts).length === 0){
      salesPerBrand.innerHTML = '<div class="small muted">No sales recorded.</div>';
      return;
    }
    Object.keys(counts).forEach(k=>{
      const r = document.createElement('div');
      r.className = 'sale-row';
      r.innerHTML = `<div>${k}</div><div style="font-weight:800">${counts[k]}</div>`;
      salesPerBrand.appendChild(r);
    });
  }

  // --- CSV export ---
  exportCsvBtn.addEventListener('click', ()=>{
    if(state.sales.length === 0){ alert('No sales to export'); return; }
    const header = ['Date','Brand','Price_USD','Commission_USD','STS'];
    const rows = state.sales.map(s => [s.date,s.brand,s.price,s.commission,s.sts]);
    const csv = [header, ...rows].map(r => r.map(c => `"${String(c).replace(/"/g,'""')}"`).join(',')).join('\\n');
    const blob = new Blob([csv], {type:'text/csv'}); const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = `sales_export_${new Date().toISOString().slice(0,10)}.csv`;
    a.click(); URL.revokeObjectURL(url);
  });

  // --- Chart rendering (Commissions per month / weekly option) ---
  function generateMonthlyAggregates(){
    // For demo: aggregate existing sales by month (Jan..Dec) by commission sums
    const monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    const data = Array(12).fill(0);
    for(const s of state.sales){
      const d = new Date(s.date);
      if(!isNaN(d)) data[d.getMonth()] += Number(s.commission);
      else {
        // if date was saved as string locale, try parsing fallback: use current month
        data[(new Date()).getMonth()] += Number(s.commission);
      }
    }
    return {labels: monthNames, values: data};
  }

  function generateWeeklyDemo(){
    // demo weekly aggregated data (7 days)
    const labels = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    const values = [0,0,0,0,0,0,0];
    for(const s of state.sales){
      const d = new Date(s.date);
      let idx = (isNaN(d) ? (new Date()).getDay() : d.getDay()); // 0 (Sun) - 6 (Sat)
      // convert Sunday (0) to index 6, Mon=1 -> 0 etc to show Mon..Sun
      idx = (idx + 6) % 7;
      values[idx] += Number(s.commission);
    }
    return {labels, values};
  }

  function renderCommChart(){
    const mode = chartMode.value; // monthly or weekly
    let labels, values;
    if(mode === 'monthly'){
      const res = generateMonthlyAggregates();
      labels = res.labels;
      values = res.values;
    } else {
      const res = generateWeeklyDemo();
      labels = res.labels;
      values = res.values;
    }

    const ctx = document.getElementById('commChart').getContext('2d');
    if(commChart) commChart.destroy();
    commChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: 'Commissions (USD)',
          data: values,
          backgroundColor: labels.map((l,i)=> {
            // gradient-like two-tone for each bar
            return i % 2 === 0 ? 'rgba(15,139,141,0.85)' : 'rgba(15,139,141,0.55)';
          }),
          borderRadius: 8,
          barThickness: 26
        }]
      },
      options: {
        plugins: { legend: { display: false } },
        scales: {
          y: { beginAtZero:true, ticks:{callback: v => '$' + v} },
          x: { grid: { display:false } }
        },
        responsive:true,
        maintainAspectRatio:false
      }
    });
  }

  // QA chart (simple donut/bar)
  function renderQAChart(){
    const ctx = document.getElementById('qaChart').getContext('2d');
    if(qaChart) qaChart.destroy();
    qaChart = new Chart(ctx, {
      type:'doughnut',
      data:{
        labels:['Good','Needs Work'],
        datasets:[{ data:[92,8], backgroundColor:['#0fb2a9','#e6e6e6'] }]
      },
      options:{ plugins:{legend:{display:false}} , maintainAspectRatio:false}
    });
  }

  // --- Views switching ---
  function showView(name){
    document.getElementById('landingView').style.display = name === 'landing' ? 'block' : 'none';
    document.getElementById('qaView').style.display = name === 'qa' ? 'block' : 'none';
    document.getElementById('trackerCard').style.display = name === 'tracker' ? 'flex' : 'flex';
    // note: tracker always visible in right column, we switch left big area instead
    if(name === 'tracker'){
      document.getElementById('landingView').style.display = 'none';
      document.getElementById('qaView').style.display = 'none';
      // show a smaller landing placeholder if needed
      // For clarity we leave tracker visible right column
    }
  }

  // --- attach nav buttons ---
  btnLanding.addEventListener('click', ()=> { showView('landing'); renderCommChart(); });
  btnQA.addEventListener('click', ()=> { showView('qa'); renderQAChart(); });
  btnTracker.addEventListener('click', ()=> { showView('tracker'); });

  toTracker.addEventListener('click', ()=> { showView('tracker'); });
  toQA.addEventListener('click', ()=> { showView('qa'); });

  // chart mode change
  chartMode.addEventListener('change', ()=> renderCommChart());

  // dark mode top button (and remember)
  document.getElementById('darkToggleTop').addEventListener('click', ()=>{
    const isDark = document.body.classList.toggle('dark');
    localStorage.setItem('sales_dash_dark', isDark ? '1' : '0');
    // re-render charts to adapt colors
    setTimeout(()=>{ renderCommChart(); renderQAChart(); }, 100);
  });

  // init UI refresh
  function refreshUI(){
    renderSalesList(); computeMetrics(); renderSalesPerBrand(); renderCommChart(); renderQAChart();
  }

  // initial render
  refreshUI();

  // helper: initial sample data for demo (only if empty)
  if(state.sales.length === 0){
    // add demo sales so chart isn't empty (optional)
    const demo = [
      {brand:'AquaTru', price:450, commission:3.3, sts:false, date: new Date(2024,0,15).toLocaleString()},
      {brand:'AirDoctor', price:120, commission:1.65, sts:false, date: new Date(2024,1,4).toLocaleString()},
      {brand:'Walkfit', price:920, commission:8.3, sts:false, date: new Date(2024,2,22).toLocaleString()},
      {brand:'AquaTru', price:600, commission:5.0, sts:false, date: new Date(2024,3,3).toLocaleString()},
      {brand:'Prosvent', price:380, commission:1.65, sts:false, date: new Date(2024,4,9).toLocaleString()},
      {brand:'AquaTru', price:300, commission:3.3, sts:false, date: new Date(2024,5,12).toLocaleString()},
    ];
    state.sales = demo.concat(state.sales);
    saveSales();
    refreshUI();
  }

})();
</script>
</body>
</html>
